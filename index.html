<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Special Question for You...</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            /* Changed background to a heartwarming gradient */
            background: linear-gradient(to bottom right, #fbcfe8, #d8b4fe); /* Soft pink to light purple */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            position: relative;
        }

        #homepage, #main-content, #pin-input-section, #quiz-section {
            transition: opacity 0.5s ease-in-out;
            width: 100%;
            max-width: 1200px;
        }

        #homepage {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            min-height: calc(100vh - 40px);
            position: relative;
        }

        #no-button {
            position: absolute;
            transition: all 0.1s ease-out;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        .section.active {
            opacity: 1;
            transform: translateY(0);
        }

        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .confetti-particle {
            position: absolute;
            animation: fall linear forwards;
            z-index: 1000;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Removed Heart animation styles */
    </style>
</head>
<body>

    <!-- Homepage: The "Do you love me?" question -->
    <div id="homepage" class="bg-white p-8 md:p-12 rounded-3xl shadow-xl flex flex-col items-center justify-center space-y-8">
        <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 leading-tight">Do you love me?</h1>
        <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-6 w-full justify-center">
            <button id="yes-button" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 ease-in-out hover:scale-105 focus:outline-none focus:ring-4 focus:ring-pink-300">
                Yes! ‚ù§Ô∏è
            </button>
            <button id="no-button" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 ease-in-out hover:scale-105 focus:outline-none focus:ring-4 focus:ring-gray-300">
                No üíî
            </button>
        </div>
    </div>

    <!-- PIN Input Section -->
    <div id="pin-input-section" class="hidden opacity-0 bg-white p-8 md:p-12 rounded-3xl shadow-xl flex flex-col items-center justify-center space-y-6 text-center">
        <h2 class="text-3xl md:text-4xl font-extrabold text-purple-600 mb-4">Enter the Secret PIN</h2>
        <p class="text-lg text-gray-700">A special code is needed to unlock the next part of this journey.</p>
        <input type="password" id="pin-input" maxlength="4" class="w-48 p-3 text-center text-2xl font-bold rounded-lg border-2 border-purple-300 focus:outline-none focus:ring-4 focus:ring-purple-200" inputmode="numeric" pattern="[0-9]*">
        <button id="submit-pin-button" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 ease-in-out hover:scale-105 focus:outline-none focus:ring-4 focus:ring-purple-300">
            Unlock My Heart
        </button>
        <p id="pin-error-message" class="text-red-500 text-sm mt-2 hidden">Incorrect PIN. Please try again.</p>
    </div>

    <!-- Quiz Section -->
    <div id="quiz-section" class="hidden opacity-0 bg-white p-8 md:p-12 rounded-3xl shadow-xl flex flex-col items-center space-y-8 text-center">
        <h2 class="text-3xl md:text-4xl font-extrabold text-teal-600 mb-4">Let's See How Well You Know My Heart...</h2>
        <p id="quiz-progress" class="text-gray-600 text-lg font-semibold">Quiz 1 of 5</p>
        <div id="quiz-content" class="w-full max-w-2xl space-y-6">
            <p id="quiz-question" class="text-2xl font-semibold text-gray-800"></p>
            <div id="quiz-options" class="flex flex-col space-y-4">
            </div>
            <button id="next-quiz-button" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 ease-in-out hover:scale-105 focus:outline-none focus:ring-4 focus:ring-teal-300 hidden">
                Next Quiz
            </button>
            <p id="quiz-feedback" class="text-lg mt-4 hidden"></p>
        </div>
        <div id="quiz-completion-message" class="hidden text-center space-y-4">
            <h3 class="text-3xl font-extrabold text-green-600">You're incredible!</h3>
            <p class="text-xl text-gray-700">You've answered all the questions. Your understanding truly touches my soul.</p>
            <button id="continue-to-proposal-button" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 ease-in-out hover:scale-105 focus:outline-none focus:ring-4 focus:ring-pink-300">
                Continue to the Special Message
            </button>
        </div>
    </div>

    <!-- Main Content: Revealed after quizzes are completed -->
    <div id="main-content" class="hidden opacity-0 bg-white p-8 md:p-12 rounded-3xl shadow-xl space-y-12 flex flex-col items-center">

        <!-- New Navigation Buttons Container -->
        <div id="navigation-buttons" class="flex flex-wrap justify-center gap-4 mb-8 w-full">
            <button id="btn-welcome" data-target="welcome-section" class="nav-button bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 ease-in-out hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">My Feelings</button>
            <button id="btn-first-sight" data-target="first-sight-section" class="nav-button bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 ease-in-out hover:scale-105 focus:outline-none focus:ring-4 focus:ring-red-300">My first sight on YOU</button>
            <button id="btn-reasons" data-target="reasons-section" class="nav-button bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 ease-in-out hover:scale-105 focus:outline-none focus:ring-4 focus:ring-green-300">Why I Love You</button>
            <button id="btn-home-with-you" data-target="proposal-full" class="nav-button bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 ease-in-out hover:scale-105 focus:outline-none focus:ring-4 focus:ring-purple-300">My heart has found its home with you and THE BIGGEST QUESTION</button>
        </div>

        <!-- Section 1: Welcome Message -->
        <section id="welcome-section" class="section text-center hidden w-full">
            <h2 class="text-3xl md:text-4xl font-extrabold text-pink-600 mb-6">My Dearest YOU,</h2>
            <div class="text-lg text-gray-700 leading-relaxed max-w-5xl mx-auto space-y-4">
                <p>
                    From the moment I met you, my world found a new kind of light. Every laugh, ONLY ONE conversation, every shared silence has woven a beautiful tapestry that I cherish more than words can say. This little website is just a small reflection of the immense feelings you inspire in me.
                </p>
                <p>
                    You're not just a girl, you're a masterpiece in motion.
                </p>
                <p>
                    Your round, expressive eyes, shimmering like calm waters, peek out from behind your pilot-framed spectacles, making every glance feel like it's meant only for me. Eyes that don‚Äôt just look, they speak, they dream, they draw me in.
                </p>
                <p>
                    And then there's your smile. Radiant, unfiltered, and utterly lethal in the sweetest way. Those charming buck teeth don‚Äôt take away from your beauty; they define it. A smile so honest, it disarms me without a word.
                </p>
                <p>
                    Your voice? It's like the first drop of honey on a quiet morning. Warm, soothing, unforgettable. Every time you speak, it feels like the noise of the world fades just to make room for your words.
                </p>
                <p>
                    When you dance, you don‚Äôt just move, you transcend. Every move, every step, is a story. You're pure grace wrapped in rhythm, like you were born to float instead of walk. Flawless doesn‚Äôt even begin to describe what you do when the music starts.
                </p>
                <p>
                    But beyond all the beauty and elegance lies something even rarer, your brilliance. You're sharp, driven, and wise beyond your years. The kind of person who doesn‚Äôt just top exams but raises the bar for everyone around you. You are calm under pressure, kind even when the world isn‚Äôt, and confident without ever being arrogant.
                </p>
                <p>
                    And your hair, impossibly long, silky, and mesmerizing, flows like poetry with every turn. One glimpse, and I am caught in a moment that makes me forget everything else.
                </p>
                <p>
                    You are not just beautiful. You're inspiring. A perfect blend of grace, strength, intelligence, and soul. To know you, even from afar, is a privilege. To admire you is a feeling that words can barely contain.
                </p>
                <p>
                    But here‚Äôs the truth I can‚Äôt escape: you hate me. I don‚Äôt know what I did or who I am in your eyes, but I feel the distance, the coldness, the indifference. And yet, even knowing that, I can't stop loving you. Not for a moment. My feelings are real, deep, and honest, not built on hope or fantasy, but on who you truly are.
                </p>
                <p>
                    Please... I know I may not deserve your love, but I am still here, holding on to a quiet prayer that one day, somehow, you might see me differently. Just give me a chance, only one chance to show you the depth of what I feel for you. Because loving you isn't a choice anymore‚Ä¶ it's who I have become.
                </p>
            </div>
        </section>

        <!-- New Section: My First Sight on YOU -->
        <section id="first-sight-section" class="section text-center hidden w-full">
            <h2 class="text-3xl md:text-4xl font-extrabold text-red-600 mb-6">My first sight on YOU</h2>
            <div class="text-lg text-gray-700 leading-relaxed max-w-5xl mx-auto space-y-4">
                <p>
                    Dear You,
                </p>
                <p>
                    It was the 14th of August, 2023. 8:05 AM.
                </p>
                <p>
                    My first day of college.
                    I didn‚Äôt know a single soul. Just a room full of strangers like me, gathered for the Soft Skills class in AB1-502. The class was loud, chaotic and then, you walked in.
                </p>
                <p>
                    You entered the classroom with a smile that lit up the room, that beautiful smile of yours, showing those adorable teeth that I‚Äôd come to remember so well. Sir asked why you were late, and you simply replied, ‚ÄúSorry,‚Äù and walked in. You didn‚Äôt seem nervous or hurried. You carried yourself with a grace I didn‚Äôt notice at first ,not then, at least.
                </p>
                <p>
                    I honestly don‚Äôt even remember what I wore that day. But I remember what you wore like it‚Äôs carved into my memory. A long, soft green gown ,the lightest shade I‚Äôve ever seen and a yellow Quechua bag hanging behind you. You jumped cutely, almost playfully, as you walked to the last bench and sat there. So effortless. So you.
                </p>
                <p>
                    Back then, I didn‚Äôt feel anything. You were just another beautiful girl in the crowd. But as the days passed, as I began seeing you more ,hearing your voice, noticing your mannerisms, feeling the aura you carried , something changed in me. My feelings grew, slowly at first, and then all at once.
                </p>
                <p>
                    I fell in love with you. Truly, deeply.
                </p>
                <p>
                    But along the way, I made mistakes. The kind of mistakes that can‚Äôt be undone. I hurt you, knowingly or unknowingly, and those moments became reasons for you to hate me, maybe even despise me. You blocked me from every social media platform, even Google Pay. It‚Äôs strange how painful digital silence can feel when it comes from the one person who means the most.
                </p>
                <p>
                    I know you don‚Äôt want me around. I know you don‚Äôt even want me to exist in your world anymore. One incident still haunts me, the day I saw you lying down on your desk, not looking well. I gathered the courage to walk up to you and ask if you had a fever. And you replied, ‚ÄúI‚Äôm not supposed to tell this to you.‚Äù
                </p>
                <p>
                    I just said, ‚ÄúOkay,‚Äù and walked away. But what I didn‚Äôt show was how that one sentence shattered me inside. I can‚Äôt explain the pain ,it felt like my heart had been ripped apart. That moment made me question everything. I genuinely felt that dying would‚Äôve been easier than feeling that kind of pain.
                </p>
                <p>
                    And yet, here I am, writing this. Not to beg for your forgiveness. Not to force you to change how you feel. But just to say that my love for you has always been real. Flawed, yes, but true. You may hate me now, and maybe forever. But a part of me will always carry your smile, your voice, and your memory, as both a lesson and a feeling I‚Äôll never forget.
                </p>
                <p>
                    With nothing but sincerity,
                    Someone who truly loved you
                </p>
            </div>
        </section>

        <section id="reasons-section" class="section text-center hidden w-full">
            <h2 class="text-3xl md:text-4xl font-extrabold text-pink-600 mb-8">Countless Reasons Why I Love You...</h2>
            <ul class="list-none p-0 space-y-4 text-lg text-gray-700 max-w-xl mx-auto">
                <li class="reason-item bg-pink-50 px-6 py-3 rounded-full shadow-sm flex items-center justify-between flex-wrap gap-2">
                    <span class="reason-text">Your infectious laughter that brightens any room.</span>
                    <button class="elaborate-button bg-yellow-400 hover:bg-yellow-500 text-gray-800 text-sm font-bold py-1 px-3 rounded-full shadow-md transition duration-200 ease-in-out">‚ú® Elaborate</button>
                    <div class="elaboration-text text-sm text-gray-600 mt-2 hidden w-full text-left p-2 bg-yellow-50 rounded-lg"></div>
                    <div class="loading-indicator text-sm text-gray-500 mt-2 hidden">Generating...</div>
                </li>
                <li class="reason-item bg-pink-50 px-6 py-3 rounded-full shadow-sm flex items-center justify-between flex-wrap gap-2">
                    <span class="reason-text">Your incredible kindness and empathy towards everyone.</span>
                    <button class="elaborate-button bg-yellow-400 hover:bg-yellow-500 text-gray-800 text-sm font-bold py-1 px-3 rounded-full shadow-md transition duration-300 ease-in-out">‚ú® Elaborate</button>
                    <div class="elaboration-text text-sm text-gray-600 mt-2 hidden w-full text-left p-2 bg-yellow-50 rounded-lg"></div>
                    <div class="loading-indicator text-sm text-gray-500 mt-2 hidden">Generating...</div>
                </li>
                <li class="reason-item bg-pink-50 px-6 py-3 rounded-full shadow-sm flex items-center justify-between flex-wrap gap-2">
                    <span class="reason-text">The way you always know how to make me feel seen and understood.</span>
                    <button class="elaborate-button bg-yellow-400 hover:bg-yellow-500 text-gray-800 text-sm font-bold py-1 px-3 rounded-full shadow-md transition duration-200 ease-in-out">‚ú® Elaborate</button>
                    <div class="elaboration-text text-sm text-gray-600 mt-2 hidden w-full text-left p-2 bg-yellow-50 rounded-lg"></div>
                    <div class="loading-indicator text-sm text-gray-500 mt-2 hidden">Generating...</div>
                </li>
                <li class="reason-item bg-pink-50 px-6 py-3 rounded-full shadow-sm flex items-center justify-between flex-wrap gap-2">
                    <span class="reason-text">Your passion for Dance, Listening Music(Melophile)</span>
                    <button class="elaborate-button bg-yellow-400 hover:bg-yellow-500 text-gray-800 text-sm font-bold py-1 px-3 rounded-full shadow-md transition duration-300 ease-in-out">‚ú® Elaborate</button>
                    <div class="elaboration-text text-sm text-gray-600 mt-2 hidden w-full text-left p-2 bg-yellow-50 rounded-lg"></div>
                    <div class="loading-indicator text-sm text-gray-500 mt-2 hidden">Generating...</div>
                </li>
                <li class="reason-item bg-pink-50 px-6 py-3 rounded-full shadow-sm flex items-center justify-between flex-wrap gap-2">
                    <span class="reason-text">Every single moment I see you in a stunned manner.</span>
                    <button class="elaborate-button bg-yellow-400 hover:bg-yellow-500 text-gray-800 text-sm font-bold py-1 px-3 rounded-full shadow-md transition duration-300 ease-in-out">‚ú® Elaborate</button>
                    <div class="elaboration-text text-sm text-gray-600 mt-2 hidden w-full text-left p-2 bg-yellow-50 rounded-lg"></div>
                    <div class="loading-indicator text-sm text-gray-500 mt-2 hidden">Generating...</div>
                </li>
            </ul>
        </section>

        <section id="proposal-section" class="section text-center py-12 bg-pink-50 rounded-3xl shadow-xl hidden w-full">
            <h2 id="proposal-intro-heading" class="text-4xl md:text-5xl font-extrabold text-pink-700 mb-8 leading-tight">
                My heart has found its home with you.
            </h2>
            <p id="proposal-intro-text" class="text-xl md:text-2xl text-gray-800 mb-10 max-w-3xl mx-auto">
                Every day with you is a gift, and I can't imagine a future without you by my side. You are the most wonderful person I've ever known, and I want to spend forever making you happy.
            </p>
            <h3 id="proposal-question" class="text-5xl md:text-6xl font-extrabold text-pink-800 mb-12 animate-pulse">
                Will you marry me?
            </h3>
            <button id="marry-me-button" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 px-10 rounded-full shadow-xl transform transition duration-300 ease-in-out hover:scale-110 focus:outline-none focus:ring-4 focus:ring-purple-300 text-2xl">
                YES! A Thousand Times YES! üíç
            </button>
        </section>

        <section id="celebration-section" class="section hidden text-center py-12 w-full">
            <h2 class="text-4xl md:text-5xl font-extrabold text-green-600 mb-6">SHE SAID YES! üéâ</h2>
            <p class="text-xl text-gray-700">My heart is overflowing with joy! Thank you for making me the happiest person alive.</p>
            <div id="confetti-container" class="relative w-full h-64 mt-8 overflow-hidden">
            </div>
        </section>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const homepage = document.getElementById('homepage');
            const mainContent = document.getElementById('main-content');
            const yesButton = document.getElementById('yes-button');
            const noButton = document.getElementById('no-button');
            const marryMeButton = document.getElementById('marry-me-button');
            const celebrationSection = document.getElementById('celebration-section');
            const confettiContainer = document.getElementById('confetti-container');

            const pinInputSection = document.getElementById('pin-input-section');
            const pinInput = document.getElementById('pin-input');
            const submitPinButton = document.getElementById('submit-pin-button');
            const pinErrorMessage = document.getElementById('pin-error-message');

            const quizSection = document.getElementById('quiz-section');
            const quizProgress = document.getElementById('quiz-progress');
            const quizQuestion = document.getElementById('quiz-question');
            const quizOptions = document.getElementById('quiz-options');
            const nextQuizButton = document.getElementById('next-quiz-button');
            const quizFeedback = document.getElementById('quiz-feedback');
            const quizCompletionMessage = document.getElementById('quiz-completion-message');
            const continueToProposalButton = document.getElementById('continue-to-proposal-button');
            const quizContent = document.getElementById('quiz-content');

            const navButtons = document.querySelectorAll('.nav-button');
            const sections = document.querySelectorAll('.section');

            const proposalSection = document.getElementById('proposal-section');
            const proposalIntroHeading = document.getElementById('proposal-intro-heading');
            const proposalIntroText = document.getElementById('proposal-intro-text');
            const proposalQuestion = document.getElementById('proposal-question');

            const elaborateButtons = document.querySelectorAll('.elaborate-button');

            const CORRECT_PIN = "1109";
            let currentQuizIndex = 0;
            let selectedAnswer = null;

            const quizzes = [
                {
                    question: "What's the first thing that captivated me about you?",
                    options: ["Your radiant smile", "Your sparkling eyes", "Your graceful walk", "All of the above"],
                    correctAnswer: "All of the above",
                    feedback: {
                        correct: "Exactly! Every part of you is captivating.",
                        incorrect: "Close, but it was truly everything about you that drew me in."
                    }
                },
                {
                    question: "If our love were a song, what genre would it be?",
                    options: ["A heartfelt ballad", "An upbeat pop anthem", "A soulful jazz piece", "A beautiful symphony"],
                    correctAnswer: "A beautiful symphony",
                    feedback: {
                        correct: "Yes, a symphony ‚Äì complex, harmonious, and deeply moving.",
                        incorrect: "Good guess, but our love is a grander composition."
                    }
                },
                {
                    question: "What's my favorite way to spend time with you?",
                    options: ["Quiet conversations", "Adventurous outings", "Simply being in your presence", "Sharing a meal"],
                    correctAnswer: "Simply being in your presence",
                    feedback: {
                        correct: "You know me so well! Just being near you is my favorite.",
                        incorrect: "Those are great, but my favorite is even simpler."
                    }
                },
                {
                    question: "What quality of yours do I admire most?",
                    options: ["Your intelligence", "Your kindness", "Your strength", "All of the above"],
                    correctAnswer: "All of the above",
                    feedback: {
                        correct: "Absolutely! You possess all these incredible qualities.",
                        incorrect: "It's hard to pick just one, isn't it? Because it's all of them."
                    }
                },
                {
                    question: "What does 'forever' mean to me, with you?",
                    options: ["A promise", "A journey", "A beautiful beginning", "An endless dream"],
                    correctAnswer: "A beautiful beginning",
                    feedback: {
                        correct: "Yes, with you, forever isn't an end, but a continuous, beautiful start.",
                        incorrect: "It's more than just a concept; it's the start of everything wonderful."
                    }
                }
            ];

            // Removed createHeart, startHeartAnimation, and stopHeartAnimation functions
            // Removed initial call to startHeartAnimation()

            function moveNoButton() {
                const homepageRect = homepage.getBoundingClientRect();
                const buttonRect = noButton.getBoundingClientRect();

                const maxLeft = homepageRect.width - buttonRect.width - 20;
                const maxTop = homepageRect.height - buttonRect.height - 20;

                const minLeft = 20;
                const minTop = 20;

                let newX = Math.random() * (maxLeft - minLeft) + minLeft;
                let newY = Math.random() * (maxTop - minTop) + minTop;

                noButton.style.left = `${newX}px`;
                noButton.style.top = `${newY}px`;
            }

            noButton.addEventListener('mouseover', moveNoButton);
            noButton.addEventListener('click', (e) => {
                e.preventDefault();
                moveNoButton();
                console.log("Nice try! You can't say no! üòâ");
            });

            yesButton.addEventListener('click', () => {
                homepage.style.opacity = '0';
                homepage.style.pointerEvents = 'none';

                setTimeout(() => {
                    homepage.classList.add('hidden');
                    pinInputSection.classList.remove('hidden');
                    setTimeout(() => {
                        pinInputSection.style.opacity = '1';
                        pinInput.focus();
                    }, 50);
                }, 500);
            });

            submitPinButton.addEventListener('click', () => {
                const enteredPin = pinInput.value;
                if (enteredPin === CORRECT_PIN) {
                    pinErrorMessage.classList.add('hidden');
                    pinInputSection.style.opacity = '0';
                    pinInputSection.style.pointerEvents = 'none';

                    setTimeout(() => {
                        pinInputSection.classList.add('hidden');
                        quizSection.classList.remove('hidden');
                        setTimeout(() => {
                            quizSection.style.opacity = '1';
                            loadQuiz(currentQuizIndex);
                        }, 50);
                    }, 500);
                } else {
                    pinErrorMessage.classList.remove('hidden');
                    pinInput.value = '';
                }
            });

            function loadQuiz(index) {
                if (index < quizzes.length) {
                    const quiz = quizzes[index];
                    quizProgress.textContent = `Quiz ${index + 1} of ${quizzes.length}`;
                    quizQuestion.textContent = quiz.question;
                    quizOptions.innerHTML = '';
                    quizFeedback.classList.add('hidden');
                    nextQuizButton.classList.add('hidden');
                    selectedAnswer = null;

                    quiz.options.forEach(option => {
                        const button = document.createElement('button');
                        button.textContent = option;
                        button.classList.add('bg-blue-100', 'hover:bg-blue-200', 'text-blue-800', 'font-semibold', 'py-3', 'px-6', 'rounded-lg', 'shadow-md', 'transition', 'duration-200', 'ease-in-out', 'transform', 'hover:scale-105', 'focus:outline-none', 'focus:ring-4', 'focus:ring-blue-100', 'text-left');
                        button.addEventListener('click', () => selectAnswer(button, option, quiz.correctAnswer, quiz.feedback));
                        quizOptions.appendChild(button);
                    });

                    Array.from(quizOptions.children).forEach(button => button.disabled = false);

                } else {
                    quizContent.classList.add('hidden');
                    quizCompletionMessage.classList.remove('hidden');
                }
            }

            function selectAnswer(clickedButton, selectedOption, correctAnswer, feedback) {
                Array.from(quizOptions.children).forEach(button => {
                    button.disabled = true;
                    button.classList.remove('bg-blue-200', 'ring-blue-100');
                    if (button.textContent === correctAnswer) {
                        button.classList.add('bg-green-200', 'text-green-800');
                    } else if (button.textContent === selectedOption) {
                        button.classList.add('bg-red-200', 'text-red-800');
                    }
                });

                selectedAnswer = selectedOption;
                if (selectedAnswer === correctAnswer) {
                    quizFeedback.textContent = feedback.correct;
                    quizFeedback.classList.remove('text-red-500');
                    quizFeedback.classList.add('text-green-500');
                } else {
                    quizFeedback.textContent = feedback.incorrect;
                    quizFeedback.classList.remove('text-green-500');
                    quizFeedback.classList.add('text-red-500');
                }
                quizFeedback.classList.remove('hidden');
                nextQuizButton.classList.remove('hidden');
            }

            nextQuizButton.addEventListener('click', () => {
                currentQuizIndex++;
                loadQuiz(currentQuizIndex);
            });

            continueToProposalButton.addEventListener('click', () => {
                quizSection.style.opacity = '0';
                quizSection.style.pointerEvents = 'none';

                setTimeout(() => {
                    quizSection.classList.add('hidden');
                    mainContent.classList.remove('hidden');
                    setTimeout(() => {
                        mainContent.style.opacity = '1';
                        showSection('welcome-section');
                    }, 50);
                }, 500);
            });

            function showSection(targetId) {
                sections.forEach(section => {
                    section.classList.remove('active');
                    section.classList.add('hidden');
                });

                proposalIntroHeading.classList.add('hidden');
                proposalIntroText.classList.add('hidden');
                proposalQuestion.classList.add('hidden');
                marryMeButton.classList.add('hidden');

                if (targetId === 'proposal-full') {
                    proposalSection.classList.remove('hidden');
                    proposalIntroHeading.classList.remove('hidden');
                    proposalIntroText.classList.remove('hidden');
                    proposalQuestion.classList.remove('hidden');
                    marryMeButton.classList.remove('hidden');

                    setTimeout(() => {
                        proposalSection.classList.add('active');
                    }, 50);
                } else {
                    const targetSection = document.getElementById(targetId);
                    if (targetSection) {
                        targetSection.classList.remove('hidden');
                        setTimeout(() => {
                            targetSection.classList.add('active');
                        }, 50);
                    }
                }
            }

            navButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const targetId = e.target.dataset.target;
                    showSection(targetId);
                });
            });

            elaborateButtons.forEach(button => {
                button.addEventListener('click', async (e) => {
                    const listItem = e.target.closest('.reason-item');
                    const reasonTextSpan = listItem.querySelector('.reason-text');
                    const elaborationTextDiv = listItem.querySelector('.elaboration-text');
                    const loadingIndicator = listItem.querySelector('.loading-indicator');

                    const reason = reasonTextSpan.textContent.trim();

                    if (elaborationTextDiv.classList.contains('hidden')) {
                        loadingIndicator.classList.remove('hidden');
                        elaborationTextDiv.classList.add('hidden');

                        try {
                            const prompt = `Elaborate on the following reason for loving someone: "${reason}". Make it sound like a personal, romantic reflection, about 2-3 sentences long. Focus on the emotional impact and why this quality is cherished.`;
                            let chatHistory = [];
                            chatHistory.push({ role: "user", parts: [{ text: prompt }] });

                            const payload = { contents: chatHistory };
                            const apiKey = "";
                            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                            const response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });

                            const result = await response.json();

                            if (result.candidates && result.candidates.length > 0 &&
                                result.candidates[0].content && result.candidates[0].content.parts &&
                                result.candidates[0].content.parts.length > 0) {
                                const text = result.candidates[0].content.parts[0].text;
                                elaborationTextDiv.textContent = text;
                                elaborationTextDiv.classList.remove('hidden');
                            } else {
                                elaborationTextDiv.textContent = "Could not elaborate at this time. Please try again.";
                                elaborationTextDiv.classList.remove('hidden');
                                console.error("Gemini API response structure unexpected:", result);
                            }
                        } catch (error) {
                            elaborationTextDiv.textContent = "Error generating elaboration. Please try again.";
                            elaborationTextDiv.classList.remove('hidden');
                            console.error("Error calling Gemini API:", error);
                        } finally {
                            loadingIndicator.classList.add('hidden');
                        }
                    } else {
                        elaborationTextDiv.classList.add('hidden');
                        elaborationTextDiv.textContent = '';
                    }
                });
            });

            marryMeButton.addEventListener('click', () => {
                proposalSection.classList.remove('active');
                proposalSection.style.opacity = '0';

                setTimeout(() => {
                    proposalSection.classList.add('hidden');

                    celebrationSection.classList.remove('hidden');
                    setTimeout(() => {
                        celebrationSection.classList.add('active');
                        triggerConfetti();
                    }, 50);
                }, 500);
            });

            function triggerConfetti() {
                const colors = ['#FFD700', '#FF69B4', '#8A2BE2', '#00CED1', '#FF4500', '#F0F8FF'];
                const numConfetti = 150;

                for (let i = 0; i < numConfetti; i++) {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti-particle');

                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = `${Math.random() * 100}%`;
                    confetti.style.top = `${Math.random() * 100}%`;
                    confetti.style.width = `${Math.random() * 8 + 4}px`;
                    confetti.style.height = `${Math.random() * 8 + 4}px`;
                    confetti.style.opacity = Math.random() * 0.7 + 0.3;
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                    confetti.style.position = 'absolute';
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';

                    confettiContainer.appendChild(confetti);

                    const animationDuration = Math.random() * 2 + 3;
                    const delay = Math.random() * 0.5;
                    const endY = window.innerHeight + 50;
                    const endXOffset = (Math.random() - 0.5) * 400;

                    confetti.animate([
                        { transform: `translateY(0) translateX(0) rotate(${Math.random() * 360}deg)`, opacity: 1 },
                        { transform: `translateY(-${window.innerHeight}px) translateX(${endXOffset}px) rotate(${Math.random() * 720 + 360}deg)`, opacity: 0 }
                    ], {
                        duration: animationDuration * 1000,
                        easing: 'ease-out',
                        delay: delay * 1000,
                        fill: 'forwards'
                    });

                    setTimeout(() => {
                        confetti.remove();
                    }, (animationDuration + delay) * 1000);
                }
            }
        });
    </script>
</body>
</html>
